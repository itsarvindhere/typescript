What if we want to use a 'switch' statement instead of if-else statements for our Discriminated unions? Something like this -

    const calculateArea = (shape: Shape) => {
        switch(shape.kind) {
            case 'circle':
                return Math.PI * shape.radius * shape.radius;
            case 'square':
                return shape.sideLength * shape.sideLength;
            default:
                return shape; // HERE 'shape' is of type 'never'
        }
    }

This will not show any errors so it looks like Narrowing is working fine here.

One thing worth mentioning is that inside 'default', the type of 'shape' is 'never'. You can verify this by hovering over 'shape' in your IDE. So, TypeScript is smart enough to see that since both 'circle' and 'square' cases are handled by us, it can safely assume that 'shape' can never be anything else.

This is also something that can be really really helpful for us to avoid situations where we maybe introduce a new Shape, but we forget to handle it in our switch statement.

Remember that nothing is assignable to 'never' type. This means that if we try to use 'shape' in a way that is not compatible with 'never', TypeScript will raise an error. This is a powerful feature that helps us catch potential bugs early in the development process.

Let's say we introduce a new shape, like this:

    type Rectangle = {
        kind: 'rectangle';
        length: number;
        width: number;
    }

And we update the 'Shape' type -

    type Shape = Circle | Square | Rectangle;

At this point, the 'default' case inside our 'switch' will say that 'shape' is of type 'Rectangle' because we have not yet handled 'rectangle' in our switch statement. But we do not want that. We want the 'default' to ensure that we have handled all the shapes in our switch statement. Well, we can do that by creating a new variable and assigning it to 'shape' in our default case -

    default:
        const check: never = shape;
        return check;

This is so useful because now, the IDE will show an error for the 'check' variable. Since we have not handled 'rectangle' shape in our switch statement, the type of 'shape' inside 'default' is 'Rectangle'. But, our 'check' variable has a type 'never'.

And as we already know, while 'never' can be assigned to any type, nothing is assignable to a 'never' type, except 'never' itself.

So, this one line now ensures that we have covered every single type of 'Shape' in our 'calculateArea' function. If not, it will show an error in the IDE.

If we do not have a 'default' case at all in the above function, then the return type of it will be 'number | undefined'. But, since we are returning 'never' in the default case, the return type is now 'number | never'. And since 'never is assignable to any type, the overall return type simply becomes 'number'.