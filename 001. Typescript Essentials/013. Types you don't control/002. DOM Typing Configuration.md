Let's say we have this tsconfig setup - 

    "target": "es2015",
    "lib": ["ES2021"],

So, we are telling TypeScript that we are targeting ES2015, but we want to include the ES2021 library features. Basically, this means TypeScript will compile our code to be compatible with ES2015, but it will also be aware of the features that were added up to ES2021. It is our responsibility to ensure that the runtime environment (like the browser or Node.js) supports these features.

Now, let's say we have this code in our TypeScript file -

    document.addEventListener('DOMContentLoaded', () => {
        const app = document.querySelector("#app");
        app.innerHTML = "<h1>Hello World!</h1>";
    });

Nothing complicated. Just some basic DOM manipulation.

But, we will notice that TypeScript will show an error in the IDE for the 'document' object, saying that it cannot find the name 'document'.

And if you look at the error, it also gives you a solution -

    Cannot find name 'document'. Do you need to change your target library? Try changing the 'lib' compiler option to include 'dom'

The error says that we need to include the 'dom' library in our 'lib' compiler option.

Remember that in last section, we learnt that if 'lib' is not specified, TypeScript will automatically include a default set of libraries based on the 'target'.

But, if we explicitly specify the 'lib' option, TypeScript will only include the libraries we mention there.

Right now, our 'lib' only includes 'ES2021', which does not have any DOM related types. That's why TypeScript is complaining about the 'document' object.

As the error says we need to include the 'dom' library in our 'lib' array like this -

    "lib": ["ES2021", "DOM"]

And boom! The error on 'document' goes away.

So, what just happened? 

Well, by adding 'DOM' to the 'lib' array, we are telling TypeScript to include the type definitions for DOM APIs. This allows TypeScript to understand and type-check code that interacts with the DOM, such as accessing 'document', 'window', and other related objects and methods.

So, the bottom-line is that when you manually specify any value for "lib", TypeScript stops including the default libraries.

Usually, the default libraries include things like -

    DOM
    ES2020 (or appropriate ES lib based on your TS version)
    DOM.Iterable
    ScriptHost

But, if we specify our own "lib" array, we need to make sure to include all the libraries we need, including "DOM" if we are working with web APIs.

Previously, we did not have "DOM" in our "lib" array, so TypeScript thought we are writing a non-DOM environment (like Node.js), and hence it complained about the 'document' object not being found.

When we added "DOM" to the "lib" array -

    "lib": ["ES2021", "DOM"]

This tells TS:

    1. include ES2021 standard API types
    2. and also browser globals like window, document, HTMLElement, etc.